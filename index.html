---
layout: default
title: Halaman Utama
---

<section class="hero">
    <div class="container">
        <h1>Nonton TV Malaysia Online Gratis</h1>
        <p>Streaming siaran TV Malaysia kualiti HD, stabil, dan lancar.</p>
        
        <!-- ADS SLOT HERO (728x90) -->
        <div class="ads-container">
            <div class="ads-label">ADVERTISEMENT</div>
            <!-- Pasang kode AdSense Anda di sini -->
        </div>
    </div>
</section>

<section id="channels" class="container main-section">
    <div class="section-header">
        <div class="title-wrapper">
            <span class="live-dot"></span>
            <h2>Channel Populer</h2>
        </div>
    </div>

    <!-- Container Utama Grid -->
    <div class="post-grid" id="post-container">
        {% for post in site.posts limit: 10 %}
        <article class="post-card">
            <a href="{{ post.url | relative_url }}" class="card-link-wrapper">
                <div class="thumb-container">
                    <img src="{{ post.image | relative_url }}" alt="{{ post.title }}" loading="lazy">
                    <span class="live-tag">LIVE</span>
                </div>
                <div class="post-info">
                    <span class="category">{{ post.category }}</span>
                    <h3>{{ post.title }}</h3>
                </div>
            </a>
        </article>
        {% endfor %}
    </div>

    <!-- Titik Pemicu Scroll (Sentinel) & Loading Indicator -->
    <div id="infinite-scroll-trigger" style="height: 50px; margin-top: 20px;">
        <div id="loading-spinner" class="spinner-hidden">
            <i class="fa fa-sync-alt fa-spin"></i> Memuat saluran lainnya...
        </div>
    </div>

    <!-- ADS SLOT BOTTOM -->
    <div class="ads-container">
        <div class="ads-label">ADVERTISEMENT</div>
        <!-- Pasang kode AdSense Anda di sini -->
    </div>
</section>

<!-- SCRIPT INFINITE SCROLL -->
<script>
let postsShown = 10; 
const postsPerLoad = 6;
let allPosts = [];
let isLoading = false;

// 1. Ambil data lengkap dari JSON secara background
fetch('{{ "/posts.json" | relative_url }}')
    .then(response => response.json())
    .then(data => {
        allPosts = data;
    });

// 2. Fungsi untuk memasukkan konten baru ke Grid
function loadMorePosts() {
    if (isLoading || postsShown >= allPosts.length) return;
    
    isLoading = true;
    const spinner = document.getElementById('loading-spinner');
    spinner.classList.remove('spinner-hidden');

    // Beri sedikit delay agar transisi terasa halus (600ms)
    setTimeout(() => {
        const container = document.getElementById('post-container');
        const nextPosts = allPosts.slice(postsShown, postsShown + postsPerLoad);
        
        nextPosts.forEach(post => {
            const article = document.createElement('article');
            article.className = 'post-card animate-in';
            article.innerHTML = `
                <a href="${post.url}" class="card-link-wrapper">
                    <div class="thumb-container">
                        <img src="${post.image}" alt="${post.title}" loading="lazy">
                        <span class="live-tag">LIVE</span>
                    </div>
                    <div class="post-info">
                        <span class="category">${post.category}</span>
                        <h3>${post.title}</h3>
                    </div>
                </a>
            `;
            container.appendChild(article);
        });

        postsShown += nextPosts.length;
        isLoading = false;
        spinner.classList.add('spinner-hidden');
        
        // Hapus pemicu jika semua post sudah tampil
        if (postsShown >= allPosts.length) {
            document.getElementById('infinite-scroll-trigger').style.display = 'none';
        }
    }, 600);
}

// 3. Intersection Observer: Deteksi saat user sampai di bawah halaman
const observer = new IntersectionObserver((entries) => {
    if (entries[0].isIntersecting) {
        loadMorePosts();
    }
}, { threshold: 0.1 });

observer.observe(document.getElementById('infinite-scroll-trigger'));
</script>
